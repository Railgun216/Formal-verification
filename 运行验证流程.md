# 神经网络鲁棒性验证 - 运行流程

## 当前状态

✅ **代码已创建完成**
- 所有 Python 文件已生成
- 代码语法检查通过
- 模块可以正常导入

⚠️ **需要您运行验证**
- 由于环境限制，需要您手动运行测试命令来验证功能

## 完整运行流程

### 第一步：安装依赖

```bash
pip install -r requirements.txt
```

如果安装失败，可以单独安装：
```bash
pip install numpy scipy
# 可选：如果需要 ONNX 支持
pip install onnx onnxruntime
```

### 第二步：运行快速测试

**测试 1：基础功能测试**
```bash
python test_verification.py
```

**测试 2：简单验证测试**
```bash
python simple_test.py
```

**测试 3：完整示例**
```bash
python example_usage.py
```

**测试 4：生成验证报告**
```bash
python verification_report.py
```

### 第三步：验证输出

运行后应该看到类似以下输出：

```
============================================================
Quick Robustness Verification Test
============================================================

1. Creating test network...
   ✓ Network created: 2 layers
   Input dim: 784, Output dim: 10

2. Creating test input...
   ✓ Input created, nominal class: 3

3. Running verification...

   Testing ε = 0.010... Result: SAFE
   Testing ε = 0.030... Result: SAFE
   Testing ε = 0.050... Result: UNKNOWN

============================================================
Test completed!
============================================================
```

### 第四步：使用自己的模型（可选）

如果您有自己的模型文件：

```python
from robustness_verifier import ReLUNetwork, RobustnessVerifier
import numpy as np

# 加载模型
network = ReLUNetwork.from_mat("your_model.mat")
# 或
network = ReLUNetwork.from_onnx("your_model.onnx")

# 创建验证器
verifier = RobustnessVerifier(network, use_exact_check=True, use_cegar=True)

# 准备输入（归一化到 [0, 1]）
x0 = np.load("your_input.npy")  # 或从其他来源加载
x0 = x0 / np.max(x0)  # 归一化

# 验证鲁棒性
epsilon = 0.01
result, counterexample = verifier.verify_robustness(x0, epsilon)

print(f"验证结果: {result.value}")
if counterexample is not None:
    print(f"找到反例！原始类别: {network.predict(x0)}, 对抗类别: {network.predict(counterexample)}")
```

## 预期结果

### 正常情况下的输出：

1. **网络创建成功**
   - 显示网络层数、输入/输出维度

2. **输入创建成功**
   - 显示输入形状和预测类别

3. **验证结果**
   - `SAFE`: 网络在该输入点是鲁棒的
   - `UNSAFE`: 找到反例（对抗样本）
   - `UNKNOWN`: 过度近似不确定

### 可能的问题：

1. **ImportError**: 缺少依赖包
   - 解决：运行 `pip install -r requirements.txt`

2. **FileNotFoundError**: 模型文件不存在
   - 解决：使用代码中的示例网络，或提供正确的模型路径

3. **内存不足**: 网络太大
   - 解决：使用较小的网络或减少 epsilon 值

## 验证检查清单

- [ ] 依赖已安装
- [ ] 可以导入模块（`import robustness_verifier`）
- [ ] 可以创建网络
- [ ] 可以创建验证器
- [ ] 可以运行验证
- [ ] 看到验证结果输出

## 快速验证命令

一键测试所有功能：
```bash
python -c "from robustness_verifier import *; import numpy as np; print('✓ 导入成功'); net=ReLUNetwork([np.random.randn(5,3)*0.1, np.random.randn(2,5)*0.1], [np.zeros(5), np.zeros(2)]); print('✓ 网络创建成功'); v=RobustnessVerifier(net); print('✓ 验证器创建成功'); r,_=v.verify_robustness(np.array([0.5,0.5,0.5]), 0.01); print(f'✓ 验证完成: {r.value}'); print('\\n所有测试通过！')"
```

## 下一步

1. 运行上述测试命令
2. 检查输出结果
3. 如有问题，查看错误信息
4. 如果一切正常，可以使用自己的模型进行验证


